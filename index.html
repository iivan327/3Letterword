<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>CVC Slot Machine</title>

<style>
body {
  font-family: system-ui, -apple-system;
  background:#f5f5f5;
  text-align:center;
  overscroll-behavior: none;
}

.machine {
  display:flex;
  justify-content:center;
  gap:20px;
  margin-top:40px;
}

.column {
  display:flex;
  flex-direction:column;
  align-items:center;
}

.wheel {
  width:80px;
  height:120px;
  overflow:hidden;
  background:white;
  border-radius:12px;
  border:2px solid #ccc;
  touch-action:none;
}

.list {
  transition: transform 0.15s ease-out;
}

.item {
  height:120px;
  line-height:120px;
  font-size:64px;
}

.lock {
  margin-top:10px;
  font-size:24px;
  border:none;
  background:none;
}

.locked {
  opacity:0.4;
}

button {
  margin-top:30px;
  font-size:20px;
  padding:10px 20px;
}
</style>
</head>

<body>

<h1>CVC Word Slot ðŸŽ°</h1>

<div class="machine" id="machine"></div>

<button onclick="randomWord()">ðŸŽ² Random Word</button>

<script>
/* ===== çœŸå¯¦ CVC å–®å­— ===== */
const words = [
  "cat","dog","bat","hat","rat","mat","cap","map","fan","man",
  "pen","hen","ten","red","bed","leg",
  "pig","big","dig","sit","hit","lip",
  "cot","hot","not","pot","top",
  "bug","hug","sun","cup","mud"
];

const slots = [
  [...new Set(words.map(w=>w[0]))],
  [...new Set(words.map(w=>w[1]))],
  [...new Set(words.map(w=>w[2]))]
];

const index = [0,0,0];
const locked = [false,false,false];

const machine = document.getElementById("machine");

/* ===== å»ºç«‹è¼ªå­ ===== */
slots.forEach((letters,i)=>{
  const col = document.createElement("div");
  col.className="column";

  const wheel = document.createElement("div");
  wheel.className="wheel";

  const list = document.createElement("div");
  list.className="list";

  letters.forEach(l=>{
    const d=document.createElement("div");
    d.className="item";
    d.textContent=l;
    list.appendChild(d);
  });

  wheel.appendChild(list);

  const lockBtn=document.createElement("button");
  lockBtn.className="lock";
  lockBtn.textContent="ðŸ”“";
  lockBtn.onclick=()=>toggleLock(i, wheel, lockBtn);

  col.appendChild(wheel);
  col.appendChild(lockBtn);
  machine.appendChild(col);

  attachDrag(wheel, list, letters.length, i);
  update(i, list);
});

/* ===== æ›´æ–°ä½ç½® ===== */
function update(i,list){
  list.style.transform = `translateY(${-index[i]*120}px)`;
}

/* ===== æ‹–æ›³é‚è¼¯ï¼ˆé‡é»žï¼‰ ===== */
function attachDrag(wheel,list,len,i){
  let startY=0;
  let currentY=0;
  let dragging=false;

  wheel.addEventListener("touchstart",e=>{
    if(locked[i]) return;
    dragging=true;
    startY=e.touches[0].clientY;
    list.style.transition="none";
  });

  wheel.addEventListener("touchmove",e=>{
    if(!dragging || locked[i]) return;
    e.preventDefault();
    currentY=e.touches[0].clientY-startY;
    list.style.transform =
      `translateY(${ -index[i]*120 + currentY }px)`;
  },{passive:false});

  wheel.addEventListener("touchend",()=>{
    if(!dragging || locked[i]) return;
    dragging=false;
    list.style.transition="transform 0.15s ease-out";

    if(currentY>40) index[i]=(index[i]+1)%len;
    if(currentY<-40) index[i]=(index[i]-1+len)%len;

    currentY=0;
    update(i,list);
  });
}

/* ===== éŽ–å®š ===== */
function toggleLock(i,wheel,btn){
  locked[i]=!locked[i];
  btn.textContent=locked[i]?"ðŸ”’":"ðŸ”“";
  wheel.classList.toggle("locked",locked[i]);
}

/* ===== Randomï¼šåªå‡ºåˆæ³•å–®å­— ===== */
function randomWord(){
  const w=words[Math.floor(Math.random()*words.length)];
  w.split("").forEach((c,i)=>{
    if(!locked[i]) index[i]=slots[i].indexOf(c);
    const list = machine.children[i].querySelector(".list");
    update(i,list);
  });
}
</script>

</body>
</html>
